\documentclass[]{article}
\hyphenation{co-rres-pon-dien-tes te-ner E-ben-sper-ger de-pre-da-do-res dis-po-ni-ble be-ne-fi-cio-sa in-di-vi-dual so-cia-li-dad mos-tra-ron fuen-tes a-cep-ta-ble ta-ma-ño o-pues-ta mo-de-lo es-tu-dian-tes e-jer-ci-cios co-rres-pon-dien-te mo-di-fi-ca-dos mo-di-fi-car-lo ma-ni-pu-lar}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifxetex
  \usepackage{fontspec,xltxtra,xunicode}
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
\else
  \ifluatex
    \usepackage{fontspec}
    \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \else
    \usepackage[utf8]{inputenc}
  \fi
\fi
\usepackage{color}
\usepackage{fancyvrb}
\DefineShortVerb[commandchars=\\\{\}]{\|}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
% Redefine labelwidth for lists; otherwise, the enumerate package will cause
% markers to extend beyond the left margin.
\makeatletter\AtBeginDocument{%
  \renewcommand{\@listi}
    {\setlength{\labelwidth}{4em}}
}\makeatother
\usepackage{enumerate}
\usepackage{graphicx}
% We will generate all images so they have a width \maxwidth. This means
% that they will get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
\else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=\maxwidth]{#1}}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex,
              colorlinks=true,
              linkcolor=blue]{hyperref}
\else
  \usepackage[unicode=true,
              colorlinks=true,
              linkcolor=blue]{hyperref}
\fi
\hypersetup{breaklinks=true, pdfborder={0 0 0}}
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}


\begin{document}

\section{Ejercicio de programación VI: Estructuras de Control}

\subsubsection{{[}IMSER 2013{]}}

\begin{center}\rule{3in}{0.4pt}\end{center}

\subsection{Archivos incluidos:}

El archivo con los ejercicios del práctico debe bajarse y descomprimirse
en disco duro, creando la carpeta \textbf{\texttt{rep-X}} (nota: no debe
dentro de ningún disco, partición o carpeta protegida a la escritura,
como puede ser un disco duro externo de backup). Usted deberá abrir el
RStudio y seleccionar dicha carpeta como su directorio de trabajo con
\texttt{setwd} o en RStudio la combinación \textbf{Ctrl + Shift + K}. En
esta carpeta se encuentran algunos archivos que usted deberá modificar:

\begin{itemize}
\item
  \textbf{\texttt{1.a-loop-for.R}}
\item
  \textbf{\texttt{1.b-extra-apply.R}}
\item
  \textbf{\texttt{2.a-zenon-recargado.R}}
\item
  \textbf{\texttt{2.b-guardar-valores.R}}
\item
  \textbf{\texttt{3.a-limites.R}}
\item
  \textbf{\texttt{3.b-no-suben.R}}
\item
  \textbf{\texttt{3.c-extra-heterogeneidad.R}}
\item
  \textbf{\texttt{3.d-extremos.R}}
\end{itemize}
Adicionalmente los siguientes archivos son necesarios, pero \textbf{no
deben ser modificados} para que el método de calificación automático
funcione correctamente:

\begin{itemize}
\item
  \texttt{datos}
\item
  \texttt{evaluar.R}
\item
  \texttt{INSTRUCCIONES.pdf}
\end{itemize}
\subsection{Mecanismo de corrección:}

Nota: más recomendaciones \textbf{importantes} se hacen en el documento
\href{http://goo.gl/P5Wnq}{Dinámica de los repartidos}.

Lo primero que debe hacer es cargar el archivo evaluar.R con la función
\texttt{source} y la codificación de caracteres ``UTF-8'' (lo cual
afecta a la función \texttt{evaluar} en particular), de la siguiente
manera:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{source}\NormalTok{(}\StringTok{"evaluar.R"}\NormalTok{, }\DataTypeTok{encoding =} \StringTok{"UTF-8"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
Nótese que hemos dejado de usar la función \texttt{options}, de forma
que de ahora en más \textbf{no ejecute el comando}:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{options}\NormalTok{(}\DataTypeTok{encoding =} \StringTok{"utf-8"}\NormalTok{)  }\CommentTok{# No me ejecuten!}
\end{Highlighting}
\end{Shaded}
Este cambio se debe a que hemos detectado que esta elección trae más
problemas que soluciones.

Si usted ha ejecutado todos los pasos anteriores correctamente, al usar
el comando \texttt{ls()} verá que \texttt{"evaluar"} figura en su sesión
y además en la consola debería ver lo siguiente:

\begin{verbatim}
Archivo de código fuente cargado correctamente

Chequeo de encoding:
  Los siguientes caracteres deben ser vocales con tilde:
    á - é - í - ó - ú
  Si *no se ven correctamente* corra el siguiente comando:
    source('evaluar.R', encoding = 'UTF-8')

Para comprobar la fecha de su archivo datos ejecute:
>> fecha.datos()
\end{verbatim}
Usted trabajará modificando los contenidos de los archivos de los
ejercicios con RStudio (u otro programa de su preferencia) según las
consignas que se describen a continuación. Luego de terminar cada
ejercicio y \textbf{guardando el archivo} correspondiente en el disco
duro, usted podrá verificar rápidamente si su respuesta es correcta
ejecutando el comando:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{evaluar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
y además podrá en todo momento verificar su puntaje con la función
\texttt{verNotas()}. Tenga siempre en cuenta que, a \textbf{menos que
sea indicado} por la letra del ejercicio, las soluciones deben ser
genéricas y por lo tanto deben servir aún si se modifican los datos
originales (i.e.: no use valores fijos si no comandos). Usualmente se
utilizan valores generados de forma aleatoria para las correcciones
automáticas. Los objetos que son evaluados en la corrección automática
estarán indicados con un asterísco en las instrucciones de cada script.
Nótese además que en los archivos \textbf{se indica claramente en dónde
se inicia y dónde finaliza su código} y que debe respetar esta
organización para que la corrección de los ejercicios funcione bien.

\paragraph{NOTA:}

se agregó la función \texttt{fecha.datos} para facilitar el acceso al a
información de (1) cuál es la versión que usted tiene en su PC y (2)
cómo encontrar la fecha de la última versión.

\subsubsection{Al finalizar}

Una vez terminados y guardados los archivos de los ejercicios del
repartido, usted deberá ejecutar \texttt{evaluar()} y seleccionar la
última opción (``Todos'') y luego subir el archivo ''datos'' (sin
extensión), incluido en la carpeta ''rep-X'', a la sección de entregas
de la portada del curso en la plataforma EVA. Este archivo se podrá
reemplazar con uno más nuevo, en caso de que desee corregir algún error;
en caso de querer que el archivo sea corregido antes de la fecha de
entrega, puede cambiarle el nombre a ``datos-finalizado'', pero en ese
caso la nota no se cambiará de ahí en adelante.

\subsubsection{Código de Honor}

Si bien animamos a que trabaje en equipos y que haya un intercambio
fluido en los foros del curso, es fundamental que las respuestas a los
cuestionarios y ejercicios de programación sean fruto del trabajo
individual. En particular, consideramos necesario que no utilice el
código creado por sus compañeros, si no que debe programar sus propias
instrucciones, ya que de lo contrario supone un sabotaje a su propio
proceso de aprendizaje. Esto implica también evitar, en la medida de lo
posible, exponer el código propio a sus colegas. Como profesores estamos
comprometidos a dar nuestro mayor esfuerzo para dar las herramientas y
explicaciones adecuadas a fin de que pueda encontrar su propio camino
para resolver los ejercicios.

En casos de planteos de dudas a través del foro, en los que considere
que es imposible expresar un problema sin exponer su própio código,
entonces es aceptable hacerlo. De todas formas en estos casos es
preferible que envíe su código por correo electrónico directamente a un
profesor, explicando la problemática.

\begin{center}\rule{3in}{0.4pt}\end{center}

\subsection{1. Conteos por fila}

\subsubsection{1.a Loop for}

Suponga que usted debe analizar regularmente matrices de datos,
obtenidos en muestreos sucesivos, con cantidades de filas variables. Una
de las tareas que se le pide realizar cotidianamente es hacer un conteo
de la cantidad de valores mayores a 45 \emph{por cada fila} de la
matriz. Para no tener que hacerlo manualmente, usted decide que lo mejor
es crear un script de R con el cual hacer este conteo automáticamente.

Para hacer el script lo mejor es usar una matriz de juguete con la cual
hacer pruebas. Para esto sirven las siguientes líneas (que también se
encuentran en el script del ejercicio):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generación de la matriz datos:}
\NormalTok{datos <- }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{rpois}\NormalTok{(}\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{125}\NormalTok{) * }\DecValTok{15}\NormalTok{, }\DecValTok{43}\NormalTok{), }\DataTypeTok{ncol =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
Para lograr su objetivo, usted deberá usar un loop \texttt{for}, con el
cual completará el vector \texttt{out}, el cual contendrá las sumas de
valores mayores a 45 por filas. Como un mini ejemplo, si su matriz
\texttt{datos} es la siguiente:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datos <- datos[}\DecValTok{1}\NormalTok{:}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{:}\DecValTok{5}\NormalTok{]}
\NormalTok{datos[}\KeywordTok{sample}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{1}\NormalTok{)] <- }\DecValTok{46}  \CommentTok{# Alguno > 45 al menos}
\NormalTok{datos}
\end{Highlighting}
\end{Shaded}
\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   59   63   43   29   42
## [2,]   36   48   43   40   50
## [3,]   34   53   52   42   52
## [4,]   47   49   38   46   50
## [5,]   53   39   54   43   44
\end{verbatim}
Entonces el vector \texttt{out} será así:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out}
\end{Highlighting}
\end{Shaded}
\begin{verbatim}
## [1] 2 2 3 4 2
\end{verbatim}
(Este es un ejemplo creado con números al azar, por supuesto.)

Nótese que el sistema de corrección espera que haya un \texttt{for} en
el script (naturalmente) y que la \emph{variable de iteración} (ver
lección 6.2) tome como valores \textbf{números enteros positivos}.

\subsubsection{1.b Extra: apply}

Luego de hacer el script del ejercicio 1.a, usted se da cuenta que lo
mismo se puede hacer y de forma ``más elegante'' con una función
\texttt{apply}. Para esto usted deduce que debe crear una función propia
capaz de contar la cantidad de valores mayores a 45 (o a un valor
variable, si usted lo prefiere) de un vector numérico cualquiera y luego
aplicar esta función con \texttt{apply} a todas las filas de
\texttt{datos} (note que cada fila es un vector cuando se las trata por
separado).

Para completar el ejercicio deberá simplemente usar \texttt{apply} para
lograr el mismo vector \texttt{out} que en el ejercicio 1.a.

\begin{center}\rule{3in}{0.4pt}\end{center}

\subsection{2. Una vez más, Zenón}

\subsubsection{2.a Zenón recargado}

Como seguramente recordará, en el Repartido I se propuso calcular la
serie que representa a la
\href{https://es.wikipedia.org/wiki/Paradojas\_de\_Zen\%C3\%B3n\#La\_dicotom.C3.ADa}{paradoja
de Zenón}, cuyo valor para el enésimo elemento se definió como:

\[
  Z_n = \sum_{i=1}^{i=n} \frac{1}{2 ^ i} \;=\;
  \frac{1}{2 ^ 1} + \frac{1}{2 ^ 2} + \frac{1}{2 ^ 3} + ... + \frac{1}{2 ^ n} \;=\;
  \frac{1}{2} + \frac{1}{4} + \frac{1}{8} + ... + \frac{1}{2 ^ n}
\]

En R, el valor de $Z_n$ se puede obtener con las siguientes líneas de
código (recomendamos que use en particular la segunda línea en su
script, para evitar problemas de redondeo):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n <- }\DecValTok{20}  \CommentTok{# El n puede ser cualquiera en verdad...}
\NormalTok{Zn <- }\KeywordTok{sum}\NormalTok{(}\DecValTok{1}\NormalTok{/(}\DecValTok{2}\NormalTok{^(}\DecValTok{1}\NormalTok{:n)))}
\end{Highlighting}
\end{Shaded}
En ocasión de aquel primer repartido, el objetivo era encontrar el
mínimo \texttt{n} que cumpliera la desigualdad $1 - Z_n < \varepsilon$,
siendo $\varepsilon = 10 ^ {-6}$. El único método con que contaba en ese
momento era manualmente cambiar el valor de \texttt{n} aumentando en una
unidad, ejecutar el código y determinar manualmente si cumplía tal
condición (para repetir el proceso en caso de que de no hacerlo). Sin
embargo con las \textbf{estructuras de control} es posible ver que se
pueden automatizar estos procedimientos, e incluso generalizarlo para
cualquier $\varepsilon$. Este es el objetivo de este ejercicio.

Para esto usted deberá usar el loop \texttt{while}, ya que es (en
principio) el más adecuado para esta tarea, pues no sabemos de antemano
cual va a ser el \texttt{n} ``correcto''. Además recuerde que el loop
\texttt{while} necesita que se cumpla una condición para continuar su
ejecución, tal como el procedimiento de encontrar el \texttt{n}
correcto.

La siguiente es la salida en la consola para el caso de
\texttt{epsilon \textless{}- 5e-2} y empezando con
\texttt{n \textless{}- 1} (aunque no lo muestre en la salida):

\begin{verbatim}
## n = 2 - Zn = 0.75 
## n = 3 - Zn = 0.875 
## n = 4 - Zn = 0.9375 
## n = 5 - Zn = 0.9688
\end{verbatim}
\textbf{Recuerde que}: \textbf{1.} en cada iteración \texttt{n} debe
aumentar en una unidad, \textbf{2.} el script debe funcionar igual de
bien para cualquier valor de \texttt{epsilon} elegido y \textbf{3.} es
lo mejor utilizar el código indicado anteriormente para obtener
\texttt{Zn} o la corrección automática tendrá problemas con el redondeo
de los valores.

\subsubsection{2.b Guardar los valores}

Luego de hacer la parte 2.a, usted decide que es buena idea guardar los
valores de \texttt{Zn} un único vector numérico, al cual llamará
\texttt{Z}. Para esto es necesario modificar tanto la preparación como
las instrucciones del loop, como recordará de las lecciones de la unidad
6.

La siguiente es la salida en la consola para el caso de
\texttt{epsilon \textless{}- 5e-2} y empezando con
\texttt{n \textless{}- 1} (aunque no lo muestre en la salida):

\begin{verbatim}
## n = 2 - Zn = 0.75 
## n = 3 - Zn = 0.875 
## n = 4 - Zn = 0.9375 
## n = 5 - Zn = 0.9688
\end{verbatim}
\begin{figure}[htbp]
\centering
\includegraphics{figure/fig1.png}
\caption{Serie de Zenón, con n (final) = 5}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Z}
\end{Highlighting}
\end{Shaded}
\begin{verbatim}
## [1] 0.5000 0.7500 0.8750 0.9375 0.9688
\end{verbatim}
La figura 1 se obtuvo con el siguiente código:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(Z, }\DataTypeTok{xlab =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{ylab =} \KeywordTok{expression}\NormalTok{(Z[n]), }\DataTypeTok{type =} \StringTok{"o"}\NormalTok{, }\DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }\DataTypeTok{ylim =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }
    \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\begin{center}\rule{3in}{0.4pt}\end{center}

\subsection{3. Línea urbana}

Como proyecto del gobierno municipal local, usted va a simular el
trayecto de un ómnibus a través de su recorrido. El objetivo es obtener
una simulación razonablemente fiel a los datos observados para esa
línea. Se supone que dicho gobierno va a utilizar los datos generados y
complementarlo con análisis matemáticos rigurosos, a fin de diseñar un
sistema de transporte óptimo que tenga un buen balance entre el costo de
flota y eficiencia de transporte.

\paragraph{Nota:}

en este ejercicio, particularmente en las partes c y d, puede facilitar
mucho la tarea hacer un diagrama de flujo sencillo antes de empezar a
escribir código.

\subsubsection{3.a Poniendo límites}

Usted ya ha hecho un modelo que, si bien es muy crudo aún, tiene los
componentes básicos necesarios. El código es el siguiente:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\NormalTok{paradas <- }\DecValTok{50}
\NormalTok{maximo <- }\DecValTok{60}
\NormalTok{pasajeros <- }\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{registro <- }\KeywordTok{numeric}\NormalTok{(paradas)}
\NormalTok{registro[}\DecValTok{1}\NormalTok{] <- pasajeros}
\NormalTok{for (i in }\DecValTok{2}\NormalTok{:paradas) \{}
    \CommentTok{# Bajan:}
    \NormalTok{pasajeros <- pasajeros - }\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}

    \CommentTok{# Suben:}
    \NormalTok{pasajeros <- pasajeros + }\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)}

    \NormalTok{registro[i] <- pasajeros  }\CommentTok{# Actualiza registro}
\NormalTok{\}}
\KeywordTok{plot}\NormalTok{(registro, }\DataTypeTok{type =} \StringTok{"o"}\NormalTok{, }\DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Parada"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"No. de pasajeros"}\NormalTok{, }
    \DataTypeTok{ylim =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\KeywordTok{max}\NormalTok{(registro)))}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, maximo), }\DataTypeTok{lty =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\begin{figure}[htbp]
\centering
\includegraphics{figure/fig2.png}
\caption{Modelo `crudo'; las líneas indican los límites que debería
tener el nro. de pasajeros}
\end{figure}

Como puede ver en el gráfico generado (fig. 2), la cantidad de pasajeros
sobrepasa en ocasiones al menos uno de los límites posibles para un bus
real (en este caso, el máximo es 60 y el mínimo es 0, naturalmente).

El objetivo de este ejercicio tiene que ver con este último:
\textbf{modificar el código de forma tal que se impongan límites a los
valores posibles de \texttt{pasajeros}}. En particular, siempre que la
cantidad de pasajeros sea mayor que el máximo estipulado (siendo que ya
subieron y bajaron los pasajeros correspondientes a ese turno), debe
corregirse el valor de \texttt{pasajeros}, dejándolo en el
\texttt{maximo}. El caso análogo debe ocurrir si \texttt{pasajeros} toma
valor negativo, cambiándolo por 0.

(En la figura 3 se muestra una simulación en la que se cumplen estas
condiciones.)

\subsubsection{3.b ¿Cuántos se quedan afuera?}

Uno de los principales objetivos del gobierno municipal es el de saber
cuántos pasajeros quedan sin poder subir al bus en cada parada. Para
esto es necesario registrar, en su simulación, el número de pasajeros
que sobrepasan el límite máximo de la capacidad del vehículo.

Usted decide crear un vector numérico, el cual tendrá tantos valores
como paradas hay en el recorrido y registrará para cada una el la
cantidad de personas que no han podido subir al vehículo. Dicho vector
será \texttt{nosuben} y deberá tener la longitud correcta \emph{antes}
de iniciar el loop. La figura 3 muestra la progresión del número de
pasajeros (negro) y personas que no pueden subir (verde) a través de una
simulación.

Note que el vector \texttt{nosuben} no puede tener valores negativos, su
valor mínimo será 0.

\begin{figure}[htbp]
\centering
\includegraphics{figure/fig3.png}
\caption{Simulación con límites y el vector nosuben en verde}
\end{figure}

\subsubsection{3.c Heterogeneidad}

El modelo creado no está nada mal, pero desde las oficinas de la
municipalidad llegan reportes de que la cantidad de personas que suben y
bajan varía mucho según la altura del recorrido en la que se encuentre
el bus. Luego de mirar cuidadosamente los datos, usted concluye que:

\begin{enumerate}[1.]
\item
  La cantidad de pasajeros que suben aumenta mucho en la la mitad del
  recorrido. Usted considera razonable decretar que a partir de la
  parada 15 y hasta la parada 35, el número promedio de gente que sube
  es de 8, en lugar de 3 como en el resto del recorrido. En otras
  palabras, en ese tramo, la cantida de pasajeros que deberá subir será
  \texttt{rpois(1, 8)}, mentras que en el resto del recorrido serán
  \texttt{rpois(1, 3)}.
\item
  Con la gente que baja el patrón es diferente: aumenta bastante la
  bajada sobre todo en la segunda mitad del trayecto. En particular, a
  partir de la parada 33 usted considera razonable determinar que bajan
  5 personas en promedio por parada. En otras palabras, antes de la
  parada 33 bajarán \texttt{rpois(1, 2)} por turno, luego serán
  \texttt{rpois(1, 5)}.
\end{enumerate}
\paragraph{Nota:}

el sistema de corrección del ejercicio espera que usted use
\textbf{siempre} líneas como estas para simular subidas o bajadas de
pasajeros:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Usando lambdas 2 y 3 como ejemplos:}
\NormalTok{pasajeros <- pasajeros - }\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)  }\CommentTok{# Bajan}
\NormalTok{pasajeros <- pasajeros + }\KeywordTok{rpois}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)  }\CommentTok{# Suben}
\end{Highlighting}
\end{Shaded}
(Aquí figuran 2 y 3 como promedio, pero en cada caso usted deberá
cambiar el valor según lo que dice la letra.)

\begin{figure}[htbp]
\centering
\includegraphics{figure/fig4.png}
\caption{La subida y bajada de pasajeros varía; las líneas verticales
muestran los cambios en subidas (rojo) y bajadas (azul)}
\end{figure}

\subsubsection{3.d Extra: extremos}

Estando ya bastante conforme con la performance de su modelo, usted se
da cuenta de un detalle: nadie, o como mucho una cantidad insignificante
de personas, toma un ómnibus para recorrer menos de 5 paradas. Por esta
razón decide modificar nuevamente su código para dar cuenta de este
detalle. Las modificaciones son las siguientes:

\begin{enumerate}[1.]
\item
  Si el bus se encuentra en una parada \emph{anterior} a la quinta,
  nadie se bajará.
\item
  Si el bus se encuentra en una parada \emph{posterior} a la 45, nadie
  se subirá.
\end{enumerate}
La figura 5 muestra un ejemplo hecho incluyendo estas dos
modificaciones. Como ya se ha mencionado anteriormente, es muy
recomendable utilizar diagramas de flujo (como el mostrado en la lección
6.1) para entender la dinámica y poder crear el código de forma más
ordenada y eficiente.

\begin{verbatim}
## Parada 2 hay 19 pasajeros
## Parada 3 hay 21 pasajeros
## Parada 4 hay 23 pasajeros
## Parada 5 hay 27 pasajeros
## Parada 6 hay 25 pasajeros
## Parada 7 hay 28 pasajeros
## Parada 8 hay 29 pasajeros
## Parada 9 hay 30 pasajeros
## Parada 10 hay 27 pasajeros
## Parada 11 hay 26 pasajeros
## Parada 12 hay 31 pasajeros
## Parada 13 hay 29 pasajeros
## Parada 14 hay 32 pasajeros
## Parada 15 hay 35 pasajeros
## Parada 16 hay 41 pasajeros
## Parada 17 hay 46 pasajeros
## Parada 18 hay 55 pasajeros
## Parada 19 hay 60 pasajeros
## Parada 20 hay 60 pasajeros
## Parada 21 hay 60 pasajeros
## Parada 22 hay 60 pasajeros
## Parada 23 hay 60 pasajeros
## Parada 24 hay 60 pasajeros
## Parada 25 hay 60 pasajeros
## Parada 26 hay 60 pasajeros
## Parada 27 hay 58 pasajeros
## Parada 28 hay 60 pasajeros
## Parada 29 hay 60 pasajeros
## Parada 30 hay 60 pasajeros
## Parada 31 hay 60 pasajeros
## Parada 32 hay 60 pasajeros
## Parada 33 hay 59 pasajeros
## Parada 34 hay 60 pasajeros
## Parada 35 hay 60 pasajeros
## Parada 36 hay 55 pasajeros
## Parada 37 hay 50 pasajeros
## Parada 38 hay 50 pasajeros
## Parada 39 hay 43 pasajeros
## Parada 40 hay 39 pasajeros
## Parada 41 hay 44 pasajeros
## Parada 42 hay 40 pasajeros
## Parada 43 hay 35 pasajeros
## Parada 44 hay 30 pasajeros
## Parada 45 hay 31 pasajeros
## Parada 46 hay 28 pasajeros
## Parada 47 hay 22 pasajeros
## Parada 48 hay 14 pasajeros
## Parada 49 hay 11 pasajeros
## Parada 50 hay 9 pasajeros
\end{verbatim}
\begin{figure}[htbp]
\centering
\includegraphics{figure/fig5.png}
\caption{Modelo final; líneas grises indican los extremos}
\end{figure}

\end{document}
